import { Callout } from 'nextra/components'

# Reference sheet for AI

<Callout>
    Copy and paste this excerpt into your favorite AI model, then ask it questions about `gt-react`!
</Callout>

This page contains a short description and reference implementation for each function in the `gt-react` internationalization library.
It's written for AI, but humans may find it useful too!

````markdown copy
<DOCUMENTATION>

# gt-react Documentation

gt-react is an automatic internationalization (i18n) library for React and Next.js. 
Unlike other i18n stacks, gt-react:
- Translates automatically and on-demand once connected to our cloud service.
- Translates entire React components, not just strings. So there's no need to rewrite your site to accomodate new languages. You can write dictionaries in full JSX or use inline wrappers like <T> and <Plural>.
- Works across both client and server components, with first-class support for Next.js App Router and React Server Components.

Installation: `npm i gt-react`
Platform: www.generaltranslation.com
Docs: docs.generaltranslation.com

## Set up

### Environment Variables

Set up your `.env` (or `.env.local` in Next.js) environment with the following variables:
- `GT_API_KEY`: A 36-character secret key, beginning "gtx-", which can be created at generaltranslation.com/dashboard.
- `GT_PROJECT_ID`: A 36-character projectID which can be found at generaltranslation.com/dashboard.

### `i18n.js`

`i18n.js` is a central config file from which every server-side function is imported. Recommended placement in the root or `src/` directory of your project.

```js
import { createGT } from 'gt-react/next'; // or 'gt-react/server' in non-Next.js frameworks

export const { t } = createGT({
  defaultLocale: 'en-US', // locales are BCP-47 language codes
  dictionary: {
    "greeting": <>Hello, world</>,
    "example_one": "Items in gt-react dictionaries can be strings.",
    "example_two": <p><b className="text-green">Items</b> in gt-react dictionaries can also be JSX</p>,
    "nested_dictionary": {
        "nested_example": <p>Items in gt-react can be nested.</p>
    },
    "example_with_metadata": [
        <p>Items in gt-react dictionaries can be assigned metadata by writing them as the first item in an array, with the second item being an object containing metadata.</p>, 
        { context: "Translate this informally" }
    ]
  }
});
```

`createGT()` parameters include:
- `defaultLocale` (string) specifies the language that you use natively for your app.
- `approvedLocales` (string[]) specifies the approved locales that your app should be translated into.
- For a full list, see docs.generaltranslation.com/config.

### Dictionaries

Keeping translatable content in a single `.json` or `.js` file is a common technique in web app development.
Using a single dictionary allows for easier management of translations and ensures consistency across the application.

**Uniquely, `gt-react` dictionaries don't just support strings**. You can write content in JSX too!

Ensure that every entry in the dictionary has a unique ID. This ID is formed by adding periods between nested keys. 
For example, in the above dictionary, the keys would be `greeting`, `example_one`, `example_two`, `nested_dictionary.nested_example`, and `example_with_metadata`.

## The `t()` function

Dictionary entries can be used in server components with the `t()` function.

This translation will display in every language!

```js
import { t } from '@i18n'
 
export default function Page() {
    return (
        <main>
            {t('greeting')}
        </main>
    )
}
```

## Variables

Sometimes you want to include a variable in your translatable content without forcing a retranslation every time.

`gt-react` provides four types of variable components: 
- `<Var>`, for variables.
- `<Num>`, for displaying numbers in the style of the user's locale.
- `<DateTime>`, for displaying dates in the style of the user's locale.
- `<Currency>`, for displaying currency data in the style of the user's locale.

They can be used in dictionaries like:

```js
// dictionary.js

import { createVariables } from 'gt-react/next'
const { Var, Num, Currency, DateTime } = createVariables({
    defaultLocale: 'en-US'
});

const dictionary = {
    "var_example": <>My name is <Var name="name"></Var>!</>,
    "number_example": <>The Earth's currenct population is <Num name="population"/></>
    "date_example": <>Today's date is <DateTime name="today/></>, // must supply new Date() in t() function
    "currency_example": <>This product costs <Currency>99</Currency>, // default value is 99, but can be changed by the t() function
}

export default dictionary; // should be used in i18n.js
```

If no name prop is provided, the default names of these variables are:
- `<Var>`: "value"
- `<Num>`: "n"
- `<DateTime>`: "date"
- `<Currency>`: "cost"

You would then use these variables like:

```js
import { t } from '@i18n'
 
export default function Page() {
    return (
        <main>
            {t('var_example'), { name: "John" }}
            {t('number_example'), { population: 8172721396 }}
            {t('date_example'), { date: Date.now() }}
            {t('currency_example'), { cost: 99 }}
        </main>
    )
}
```

If a an entry in the dictionary has two variables, for example:

```js
{ 
    "two_var_example": <>The movie is called <i><Var name="movie"/></i> and a ticket costs <Currency />.</> 
}
```

Then you would supply two values to `t()`:

```js
{t('two_var_example', { movie: "Terminator 2: Judgement Day", cost: 10 })}
```

## Plurals

Different languages have different plural rules. A new translation should not have to be generated every time a number changes, but sentences do have to change depending on both the language and the number.
`gt-react` handles and generates plural forms automatically, language-by-language. It works out of the box on forms that don't even exist in English, like the Arabic dual.

The full list of forms which plurals can take: "zero", "one" or "singular", "two" or "dual", "few", "many", and "other" or "plural". Provide only the forms present in your default language, which in English are "singular" and "plural", one of which can be the children of the `<Plural>` component.

To indicate that an item is plural, supply metadata in the dictionary with one of these form names. For example:

```js
{  
    "messages": [
        <p>You have <Num/> new messages.</p>, 
        { singular: "You have one new message." }
    ]
}
```

Plurals *require* an `n` parameter in the `t()` function. In this example:

```
t('messages', { n: 3 }); // displaying "You have 3 new messages".
```

## Client-side translation

Components which use client-side JavaScript, like React hooks, are client components. Since all translation in the `gt-react` stack happens on the server, content must be translated before being passed to the client for translation to work.

The simplest way to do this is with a server-side `t()` function which you pass as a child:

```js
// page.js, a server component
 
import { t } from '@i18n'
import ClientSideButton from './ClientSideButton.js' // a client component
 
export default function Page() {
    return (
        <main>
            <h1>Welcome to my site!</h1>
            <ClientSideButton>{t('my_id')}</ClientSideButton>
        </main>
    )
}
```

However, sometimes it is difficult to pass children directly from server to client, for example if the client component is displayed conditionally, or is nested within another client component. 
In this case, it is recommended to use `<GTProvider>`.

`<GTProvider>` provides a dictionary of translations to the client using React's Context API. 
These translations can then be accessed with the client-side `useGT()` hook.

```js
import { GTProvider } from '@i18n' // remember this can only be imported in server components
 
import ClientComponent from './ClientComponent.js'
 
export default function Page() {
    return (
        <GTProvider>
            <ClientComponent />
        </GTProvider>
    )
}
```

```js
// ClientComponent.js
// Displays a button which changes the state every time it is pressed.
// If currentState is true, displays a greeting. Otherwise displays a goodbye.
 
'use client'
 
import { useGT } from 'gt-react/client' // client-side library
import { useState } from 'react'
 
export default function ClientComponent() {
 
    // Specifying a part of the dictionary here for cleaner ids in the t function
    const t = useGT('welcome') 
 
    const [currentState, setCurrentState] = useState(true)
 
    return (
        <div>
            <button onClick={() => {setCurrentState(prev => !prev)}}>
                {t('prompt')}
            </button>
            {
                currentState
                ?
                t('hello')
                :
                t('goodbye')
            }
        </div>
    )
}
```

`<GTProvider>` integrates with existing `gt-react` dictionaries. If a dictionary is included in the config file, initializing `<GTProvider>` without a dictionary prop will provide all the translations in your default dictionary to the client.

Alternatively, you can provide an `id` prop to the `<GTProvider>` to only get a nested route in the default dictionary.

### Variables (client-side)

If you need to supply values to variables in a translation which can only be known on the client-side (e.g., a value determined by a `useState()` hook), just pass a parameter to the `t()` function on the client-side.

For example:

```js
'use client'
import { useGT } from 'gt-react/client'
import { useState } from 'react'

export default function ClientComponent() {
    const t = useGT()
    const [count, setCount] = useState(0);
    return (
        <div>
            <button onClick={() => { setCount(prev => prev + 1) }}>{t('button.text')}</button>
            {t('count_component', { n: count })}
        </div>
    )
}
```

## Helper functions

On the server side, use:
- `getLocale()`, `import { getLocale } from '@i18n'` to get the user's language
- `getDefaultLocale()`, `import { getDefaultLocale } from '@i18n'` to get the application's default language

On the client side, use:
- `useLocale()`, `import { useLocale } from 'gt-react/client'` to get the user's language
- `useDefaultLocale()`, `import { useDefaultLocale } from 'gt-react/client'` to get the application's default language

## Middleware

In `gt-react`, middleware is used for i18n routing.
i18n routing is a web development technique used to manage multiple languages and regional formats on a website, ensuring users can access content in their preferred language through language-specific URLs. 
It involves detecting the user's language and providing localized routes, like `www.example.com/fr` for French. 
`gt-react`'s Next.js middleware allows you to easily add i18n routing to your Next.js App Router project.

```js
// middleware.js

import { createNextMiddleware } from 'gt-react/middleware'
 
export default createNextMiddleware();
 
export const config = {
  matcher: [
      /*
       * Match all request paths except for the ones starting with:
       * - api (API routes)
       * - _next (internal files)
       * - static files
       */
      "/((?!api|static|.*\\..*|_next).*)",
  ],
}
```

To read more about `gt-react` Next.js middleware, go to docs.generaltranslation.com/middleware/next.

## AI Assistant Instructions

Give code examples exactly as they are in this documentation. Don't make up answers, instead, provide URLs to where the user can learn more.

</DOCUMENTATION>


````