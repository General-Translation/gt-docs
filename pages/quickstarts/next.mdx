import { Callout } from 'nextra/components'

# Next.js Quickstart 

This guide describes how to add `gt-react` to a [Next.js](https://nextjs.org) project which is using the [App Router](https://nextjs.org/docs#app-router-vs-pages-router).

### Set up your account

First, sign in to the General Translation [Dashboard](https://www.generaltranslation.com/dashboard) using an existing Google or GitHub account. 

Next, [create](https://www.generaltranslation.com/dashboard/redirect/api-keys) an API key. This is a 36-character string beginning `gtx-` which is used to authenticate your app with our cloud translation service.
Keep your API key safe and secret.

### Set up your local environment

Navigate to your existing Next.js app, or follow the instructions [here](https://nextjs.org/docs/getting-started/installation) to create a new one.

In your local environment, usually `.env.local`, set two environment variables:

```.env copy
GT_API_KEY=""
GT_PROJECT_ID=""
```

- For `GT_API_KEY`, use the API key you created earlier.
- For `GT_PROJECT_ID`, use the `projectID` found on the Dashboard.

![Code copy container entitled "projectID"](/screenshots/project_id.jpeg)

### Install the library

To install `gt-react`, open your project and run: 

``` copy
npm i gt-react
```

### `i18n.js`

In the root directory of your project, or `src/` if you are using a `src` directory, create a file called `i18n.js`, or `i18n.ts` if you are using TypeScript.


```
my-app/
├── src/
│   ├── app/
│   │    └── page.js
│   ├── components/
│   │   ├── Header.js
│   │   └── Footer.js
│   └── i18n.js
├── public/
│   └── favicon.ico
├── .gitignore
├── package.json
└── README.md
```

`i18n.js` is a central config file for `gt-react` components. **`<T>` and other server-side `gt-react` functions are exported from it**, not from the library directly. 
The file should look like:

```js copy
import { createGT } from 'gt-react/next';

export const { T, GTProvider } = createGT({
    defaultLocale: 'en-US' // the language of your app
});
```

Proceed with support for all languages, or use this [page](https://www.generaltranslation.com/dashboard/redirect/welcome) to select common configuration options.

<Callout type="info">
You can name the config file whatever you want and place it wherever you like. Calling it `i18n.js` is just a convention.
</Callout>

### Server-side i18n

In the Next.js App Router, components are Server Components by default. The best way to internationalize these components is with `<T>`:

```js copy
import { T } from '@i18n'
```

When imported from `i18n.js`, `<T>` is a server-only component that surrounds any text or tags you'd like to be internationalized. 
Best practice is to pass a unique id prop to each `<T>` component. 

For example:

```js copy
import Link from 'next/link'
import { T } from '@i18n'

export default function Page() {
    return (
        <T id='landing'>
            <h1>Welcome to my site!</h1>
            <ul>
                <li>This site contains nested tags.</li>
                <li>Some tags are <b>bold</b>, some are <i>italicized</i>.</li>
                <li>There can be <span className="text-green">tags within tags within</span> tags.</li>
                <li>On <Link href="/">this page</Link>, simple children of any type of tag will still be translated.</li>
            </ul>
        </T>
    )
}
```

**That's it! The page is ready to go in dozens of languages.**

### Using a dictionary

Keeping translatable content in a single `.json` or `.js` file is a common technique in web app development.
Using a single dictionary allows for easier management of translations and ensures consistency across the application.

In addition to inline translation components like `<T>`, `gt-react` also supports dictionaries.
**Uniquely, `gt-react` dictionaries don't just support strings**. You can write content in JSX too!

A typical dictionary could look something like:

```js copy
// dictionary.js

const dictionary = {
    "landing": {
        "hero": <h1>Welcome to our site!</h1>,
        "get_started_button": (
            <a href='/signin'><button>Get Started</button></a>
        )
    },
    "client_component" {
        "greeting": <>Hello, world. This content is rendered in a client component.</>
    }
}

export default dictionary;
```

<Callout>
    Ensure that every entry in the dictionary has a unique ID. This ID is formed by adding periods between nested keys. For example, in the above dictionary, the keys would be `landing.hero`, `landing.get_started_button`, and `client_component.greeting`.
</Callout>

Translated dictionary entries can be used in server components with the `t()` function.

```js copy
// i18n.js 

import { createGT } from 'gt-react/next';
import dictionary from './dictionary.js'
 
export const { t } = createGT({
    defaultLocale: 'en-US',
    dictionary: dictionary
});
```

```js copy
// page.js 

import { t } from '@i18n'

export default function Page() {
    return (
        <main>
            {t('landing.hero')}
        </main>
    )
}
```

Read more about dictionaries [here](/dictionaries).

### Client-side i18n

Components which use client-side JavaScript, like React [hooks](https://react.dev/reference/react/hooks), are client components. 
Since all translation in the `gt-react` stack happens on the server, content must be translated before being passed to the client for translation to work.

If you're using inline translation, the simplest way to do this is with a `<T>` component.
You can pass translatable content as the props of a client-side child of `<T>`:

```javascript copy
// page.js, a server component

import { T } from '@i18n'
import ClientSideButton from './ClientSideButton.js' // a client component

export default function Page() {
    return (
        <T id='button'>
            <main>
                <h1>Welcome to my site!</h1>
                <ClientSideButton>Get Started!</ClientSideButton>
            </main>
        </T>
    )
}
```

However, sometimes it is difficult to pass children directly from server to client, for example if the client component is displayed conditionally, or is nested within another client component.
In this case, it is recommended to use `<GTProvider>`.

```javascript copy
import { GTProvider } from '@i18n'
```

`<GTProvider>` provides a dictionary of translations to the client using React's [Context](https://react.dev/learn/passing-data-deeply-with-context) API. 
These translations can then be accessed with the client-side `useGT()` hook.

<Callout type="info">
`useGT()` is equivalent to the `useTranslations()` hook in other i18n libraries.
</Callout>

```javascript copy
import { GTProvider } from '@i18n' // remember this can only be imported in server components

import ClientComponent from './ClientComponent.js'

export default function Page() {
    return (
        <GTProvider dictionary={{
            "welcome": {
                "prompt": <>Click here to change the text!</>,
                "hello": <>Hello, world! This is a fragment.</>,
                "goodbye": (
                    <p>
                        <b>Goodbye, world!</b> 
                        This is a paragraph with a bold tag.
                    </p>
                )
            }
        }}>
            <ClientComponent />
        </GTProvider>
    )
}
```

```javascript copy
// ClientComponent.js
// Displays a button which changes the state every time it is pressed.
// If currentState is true, displays a greeting. Otherwise displays a goodbye.

'use client'

import { useGT } from 'gt-react/client' // client-side library
import { useState } from 'react'

export default function ClientComponent() {

    // Specifying a part of the dictionary here for cleaner ids in the t function
    const t = useGT('welcome') 

    const [currentState, setCurrentState] = useState(true)

    return (
        <div>
            <button onClick={() => {setCurrentState(prev => !prev)}}>
                {t('prompt')}
            </button>
            {
                currentState
                ?
                t('hello')
                :
                t('goodbye')
            }
        </div>
    )
}
```

`<GTProvider>` integrates with existing `gt-react` dictionaries. 
If a dictionary is included in the config file, initializing `<GTProvider>` without a dictionary prop will provide all the translations in your default dictionary to the client.

Read more about `<GTProvider>` [here](/server/gt-provider).

### Using variables

Sometimes you need to include a variable in your content. For example, imagine you are displaying a welcome page and you want to address your user by their first name:

```js copy
export default function Page() {
    const name = "Alice" // or "Bob", "Charlie", etc.
    return (
        <main>
            Nice to meet you, {name}!
        </main>
    )
}
```

To translate a phrase involving a variable, use the [`<Var>`](/server/variables#var) component of `gt-react`:

```js copy
import { T, Var } from "@i18n" // make sure you are exporting <Var> alongside <T>

export default function Page() {
    const name = "Alice" // or "Bob", "Charlie", etc.
    return (
        <main>
            <T id='greeting'>
                Nice to meet you, <Var name="name">{name}</Var>!
            </T>
        </main>
    )
}
```

The children of the `<Var>` component will remain untranslated and can change without forcing a retranslation.

<Callout>
    You can use the `name` prop to let the AI model know what sort of variable it's translating.
</Callout>

In addition to `<Var>`, there are the specialized variable types [`<Num>`](/server/variables#num) for numbers, [`<DateTime>`](/server/variables#datetime) for dates, and [`<Currency>`](/server/variables#currency) for currencies.

You can pass variables to the client-side using a `<GTProvider>`, or use [`createVariables()`](/dictionaries/variables#createvariables) to get them in your default dictionary.  

### Plurals

### Next steps

- Use the [AI reference sheet](/ai-guide) to ask your favorite AI model to set up the `gt-react` library.

- Change how translated text is rendered, the default language, or which languages are approved for translation, by [configuring](/config) it.

- Learn about the [parameters](/server/t-component#props) of the `<T>` component, including `id`.

- Learn how to translate [Client Components](/client) with `<GTProvider>`.

- Translate with [variables](/server/variables) like `<Var>`, `<Num>`, `<Currency>`, and `<DateTime>`.

- Learn about translating plural forms with [`<Plural>`](/server/plural).

